<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>SlimLine Webpages</title>
		<link rel="stylesheet" href="scripts/css/bundle.css">
	</head>
	<body class="has-background-dark has-text-light">
		<!-- sidebar end -->
		<div id="login" class="columns is-vcentered m-0">
			<!-- mainbar start -->
				<div class="column is-4 is-offset-4">
					<!-- start panel -->
						<div class="has-text-centered is-size-1"><ion-icon name="person-circle" ></ion-icon></div>
						<div class="has-text-centered is-size-3 mb-4 has-text-weight-bold">Login</div>
						<form id="loginform" method="GET" action="SysCgi/Login.cgi">
							<input name="Username" class="input" type="text" placeholder="Name" style="border-bottom-right-radius: 0px;border-bottom-left-radius: 0px;">
							<input name="Password" class="input" type="password" placeholder="Password" style="border-top-right-radius: 0px;border-top-left-radius: 0px;">
							<div class="buttons">
								<button class="button has-text-weight-bold is-primary is-fullwidth mt-5" name="Action" value="Login">Enter</button>
							</div>
						</form>
					<!-- end panel -->
				</div>
			<!-- mainbar end -->
		</div>
		<script type="module">
		document.querySelector('#loginform').addEventListener( 'submit', function(event) {

			event.preventDefault();

			const XHR = new XMLHttpRequest();
			var i;
			let url = new URL("SysCgi/Login.cgi",document.location);

			for (i = 0; i < this.length ;i++) {
				url.searchParams.set( this.elements[i].name, this.elements[i].value);
    		}

			// Define what happens on successful data submission
			XHR.addEventListener( 'load', function(event) {
				if (XHR.readyState != 4) return;
				if (XHR.status == 401) {
					alert("Wrong credentials");
					return;
				}
				window.location.href = XHR.responseURL;

			} );

			// Define what happens in case of error
			XHR.addEventListener( 'error', function(event) {
				alert( 'Oops! Something went wrong.' );
			} );

			// Set up our request
			XHR.open( 'GET', url );

			// Add the required HTTP header for form data POST requests
			XHR.setRequestHeader( 'Content-Type', 'application/x-www-form-urlencoded;charset=utf-8' );

			// Finally, send our data.
			XHR.send();

		})
		</script>
	</body>
</html>